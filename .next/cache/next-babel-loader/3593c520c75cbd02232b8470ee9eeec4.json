{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport Head from \"next/head\";\nimport http from \"../utils/http\";\nimport { default as SearchComponent } from \"../components/search\";\nimport Post from \"../components/post\";\nimport Error from \"../components/error\";\n\nconst Search = props => {\n  const {\n    0: value,\n    1: setValue\n  } = useState(props.q);\n  const {\n    0: posts,\n    1: setPosts\n  } = useState(props.posts);\n  const {\n    0: page,\n    1: setPage\n  } = useState(0);\n  useEffect(() => {\n    window.addEventListener(\"scroll\", windowListener);\n    return () => {\n      window.removeEventListener(\"scroll\", windowListener);\n    };\n  }, []);\n  useEffect(() => {\n    if (page > 0) {\n      http.get(\"arama.php\", {\n        params: {\n          aranan: value,\n          s: page\n        }\n      }).then(res => res.data).then(res => setPosts([...posts, ...res.postlar]));\n    }\n\n    console.log(page, props.total);\n  }, [page]);\n\n  const windowListener = () => {\n    if (page < props.total - 1) {\n      if (window.innerHeight + document.documentElement.scrollTop + 200 >= document.documentElement.offsetHeight) {\n        setPage(page + 1);\n      }\n    } else window.removeEventListener(\"scroll\", windowListener);\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-2035186029\" + \" \" + \"content\"\n  }, __jsx(Head, null, __jsx(\"title\", {\n    className: \"jsx-2035186029\"\n  }, \"arama - \", props.q)), __jsx(SearchComponent, {\n    value: value,\n    onChange: e => setValue(e.target.value),\n    onSubmit: e => {\n      e.preventDefault();\n\n      if (value) {\n        http.get(\"arama.php\", {\n          params: {\n            aranan: value\n          }\n        }).then(res => setPosts(res.data.postlar));\n      }\n    }\n  }), posts && posts.map(p => __jsx(Post, {\n    post: p,\n    key: p.post_id\n  })), !posts.length && __jsx(Error, {\n    msg: \"\\xD6yle bir nos yok\"\n  }), __jsx(_JSXStyle, {\n    id: \"2035186029\"\n  }, \".content.jsx-2035186029{margin:0 auto;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkU6XFxwcm9qZWN0c1xcbm9zYmlyLWZyb250ZW5kXFxwYWdlc1xcc2VhcmNoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWdFa0IsQUFHeUIsY0FDaEIiLCJmaWxlIjoiRTpcXHByb2plY3RzXFxub3NiaXItZnJvbnRlbmRcXHBhZ2VzXFxzZWFyY2guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xyXG5pbXBvcnQgSGVhZCBmcm9tIFwibmV4dC9oZWFkXCI7XHJcbmltcG9ydCBodHRwIGZyb20gXCIuLi91dGlscy9odHRwXCI7XHJcbmltcG9ydCB7IGRlZmF1bHQgYXMgU2VhcmNoQ29tcG9uZW50IH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2VhcmNoXCI7XHJcbmltcG9ydCBQb3N0IGZyb20gXCIuLi9jb21wb25lbnRzL3Bvc3RcIjtcclxuaW1wb3J0IEVycm9yIGZyb20gXCIuLi9jb21wb25lbnRzL2Vycm9yXCI7XHJcbmNvbnN0IFNlYXJjaCA9IHByb3BzID0+IHtcclxuICBjb25zdCBbdmFsdWUsIHNldFZhbHVlXSA9IHVzZVN0YXRlKHByb3BzLnEpO1xyXG4gIGNvbnN0IFtwb3N0cywgc2V0UG9zdHNdID0gdXNlU3RhdGUocHJvcHMucG9zdHMpO1xyXG4gIGNvbnN0IFtwYWdlLCBzZXRQYWdlXSA9IHVzZVN0YXRlKDApO1xyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgd2luZG93TGlzdGVuZXIpO1xyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgd2luZG93TGlzdGVuZXIpO1xyXG4gICAgfTtcclxuICB9LCBbXSk7XHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGlmIChwYWdlID4gMCkge1xyXG4gICAgICBodHRwXHJcbiAgICAgICAgLmdldChcImFyYW1hLnBocFwiLCB7XHJcbiAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgYXJhbmFuOiB2YWx1ZSxcclxuICAgICAgICAgICAgczogcGFnZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5kYXRhKVxyXG4gICAgICAgIC50aGVuKHJlcyA9PiBzZXRQb3N0cyhbLi4ucG9zdHMsLi4ucmVzLnBvc3RsYXJdKSk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhwYWdlLHByb3BzLnRvdGFsKVxyXG4gIH0sIFtwYWdlXSk7XHJcbiAgY29uc3Qgd2luZG93TGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICBpZiAocGFnZSA8IHByb3BzLnRvdGFsIC0gMSkge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgd2luZG93LmlubmVySGVpZ2h0ICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCArIDIwMCA+PVxyXG4gICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vZmZzZXRIZWlnaHRcclxuICAgICAgKSB7XHJcbiAgICAgICAgc2V0UGFnZShwYWdlICsgMSk7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCB3aW5kb3dMaXN0ZW5lcik7XHJcbiAgfTtcclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50XCI+XHJcbiAgICAgIDxIZWFkPlxyXG4gICAgICAgIDx0aXRsZT5hcmFtYSAtIHtwcm9wcy5xfTwvdGl0bGU+XHJcbiAgICAgIDwvSGVhZD5cclxuICAgICAgPFNlYXJjaENvbXBvbmVudFxyXG4gICAgICAgIHZhbHVlPXt2YWx1ZX1cclxuICAgICAgICBvbkNoYW5nZT17ZSA9PiBzZXRWYWx1ZShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgb25TdWJtaXQ9e2UgPT4ge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGh0dHBcclxuICAgICAgICAgICAgICAuZ2V0KFwiYXJhbWEucGhwXCIsIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgICBhcmFuYW46IHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAudGhlbihyZXMgPT4gc2V0UG9zdHMocmVzLmRhdGEucG9zdGxhcikpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH19XHJcbiAgICAgIC8+XHJcbiAgICAgIHtwb3N0cyAmJiBwb3N0cy5tYXAocCA9PiA8UG9zdCBwb3N0PXtwfSBrZXk9e3AucG9zdF9pZH0gLz4pfVxyXG4gICAgICB7IXBvc3RzLmxlbmd0aCAmJiA8RXJyb3IgbXNnPVwiw5Z5bGUgYmlyIG5vcyB5b2tcIiAvPn1cclxuICAgICAgPHN0eWxlIGpzeD57YFxyXG4gICAgICAgIC5jb250ZW50IHtcclxuICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xyXG4gICAgICAgIH1cclxuICAgICAgYH08L3N0eWxlPlxyXG4gICAgPC9kaXY+XHJcbiAgKTtcclxufTtcclxuU2VhcmNoLmdldEluaXRpYWxQcm9wcyA9IGFzeW5jICh7IHF1ZXJ5IH0pID0+IHtcclxuICBjb25zdCBkYXRhID0gYXdhaXQgaHR0cFxyXG4gICAgLmdldChcImFyYW1hLnBocFwiLCB7XHJcbiAgICAgIHBhcmFtczoge1xyXG4gICAgICAgIGFyYW5hbjogcXVlcnkucVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5kYXRhKTtcclxuICByZXR1cm4ge1xyXG4gICAgcG9zdHM6IGRhdGEucG9zdGxhcixcclxuICAgIHRvdGFsOiBkYXRhLnRvcGxhbSxcclxuICAgIHE6IHF1ZXJ5LnFcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgU2VhcmNoO1xyXG4iXX0= */\\n/*@ sourceURL=E:\\\\projects\\\\nosbir-frontend\\\\pages\\\\search.js */\"));\n};\n\nSearch.getInitialProps = async ({\n  query\n}) => {\n  const data = await http.get(\"arama.php\", {\n    params: {\n      aranan: query.q\n    }\n  }).then(res => res.data);\n  return {\n    posts: data.postlar,\n    total: data.toplam,\n    q: query.q\n  };\n};\n\nexport default Search;","map":{"version":3,"sources":["E:/projects/nosbir-frontend/pages/search.js"],"names":["React","useState","useEffect","Head","http","default","SearchComponent","Post","Error","Search","props","value","setValue","q","posts","setPosts","page","setPage","window","addEventListener","windowListener","removeEventListener","get","params","aranan","s","then","res","data","postlar","console","log","total","innerHeight","document","documentElement","scrollTop","offsetHeight","e","target","preventDefault","map","p","post_id","length","getInitialProps","query","toplam"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Head from \"next/head\";\r\nimport http from \"../utils/http\";\r\nimport { default as SearchComponent } from \"../components/search\";\r\nimport Post from \"../components/post\";\r\nimport Error from \"../components/error\";\r\nconst Search = props => {\r\n  const [value, setValue] = useState(props.q);\r\n  const [posts, setPosts] = useState(props.posts);\r\n  const [page, setPage] = useState(0);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"scroll\", windowListener);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", windowListener);\r\n    };\r\n  }, []);\r\n  useEffect(() => {\r\n    if (page > 0) {\r\n      http\r\n        .get(\"arama.php\", {\r\n          params: {\r\n            aranan: value,\r\n            s: page\r\n          }\r\n        })\r\n        .then(res => res.data)\r\n        .then(res => setPosts([...posts,...res.postlar]));\r\n    }\r\n    console.log(page,props.total)\r\n  }, [page]);\r\n  const windowListener = () => {\r\n    if (page < props.total - 1) {\r\n      if (\r\n        window.innerHeight + document.documentElement.scrollTop + 200 >=\r\n        document.documentElement.offsetHeight\r\n      ) {\r\n        setPage(page + 1);\r\n      }\r\n    } else window.removeEventListener(\"scroll\", windowListener);\r\n  };\r\n  return (\r\n    <div className=\"content\">\r\n      <Head>\r\n        <title>arama - {props.q}</title>\r\n      </Head>\r\n      <SearchComponent\r\n        value={value}\r\n        onChange={e => setValue(e.target.value)}\r\n        onSubmit={e => {\r\n          e.preventDefault();\r\n          if (value) {\r\n            http\r\n              .get(\"arama.php\", {\r\n                params: {\r\n                  aranan: value\r\n                }\r\n              })\r\n              .then(res => setPosts(res.data.postlar));\r\n          }\r\n        }}\r\n      />\r\n      {posts && posts.map(p => <Post post={p} key={p.post_id} />)}\r\n      {!posts.length && <Error msg=\"Ã–yle bir nos yok\" />}\r\n      <style jsx>{`\r\n        .content {\r\n          margin: 0 auto;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\nSearch.getInitialProps = async ({ query }) => {\r\n  const data = await http\r\n    .get(\"arama.php\", {\r\n      params: {\r\n        aranan: query.q\r\n      }\r\n    })\r\n    .then(res => res.data);\r\n  return {\r\n    posts: data.postlar,\r\n    total: data.toplam,\r\n    q: query.q\r\n  };\r\n};\r\n\r\nexport default Search;\r\n"]},"metadata":{},"sourceType":"module"}