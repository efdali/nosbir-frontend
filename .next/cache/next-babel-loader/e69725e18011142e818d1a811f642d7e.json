{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"next/router\";\nimport { withAuth } from \"../utils/auth\";\nimport { fetchGroups, groupsSuccess } from \"../store/actions/groupActions\";\nimport Loading from \"../components/loading\";\nimport Error from \"../components/error\";\nimport http from \"../utils/http\";\nimport { shareTextPost, shareImagePost } from \"../store/actions/shareActions\";\nimport { toast } from \"react-toastify\";\n\nclass NewPost extends Component {\n  static async getInitialProps({\n    store\n  }) {\n    const asyncGroups = await http.get(\"gruplar.php\").then(res => res.data).then(res => {\n      if (res.durum) {\n        return res.gruplar;\n      } else {\n        return [];\n      }\n    }).catch(err => []);\n    return {\n      asyncGroups\n    };\n  }\n\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"RenderGroups\", () => {\n      const {\n        groups,\n        isLoading,\n        isRejected,\n        errorMsg\n      } = this.props.groups;\n      if (isLoading) return __jsx(Loading, null);else if (isRejected) return __jsx(Error, {\n        msg: errorMsg\n      });else if (groups.length <= 0) return __jsx(Error, {\n        msg: \"Payla\\u015F\\u0131m yapabilece\\u011Finiz grup bulunamad\\u0131.L\\xFCtfen sonra tekrar deneyin\"\n      });else {\n        return __jsx(\"ul\", null, groups.map((g, i) => __jsx(\"li\", {\n          key: i\n        }, __jsx(\"a\", {\n          className: this.state.groupValue === g.group_id ? \"active\" : \"\",\n          onClick: e => this.changeGroup(e, g.group_id)\n        }, g.name.toLowerCase()))));\n      }\n    });\n\n    _defineProperty(this, \"changeGroup\", (e, id) => {\n      e.preventDefault();\n      this.setState({\n        groupValue: id\n      });\n      console.log(this.state.groupValue === id);\n    });\n\n    _defineProperty(this, \"shareHandler\", e => {\n      e.preventDefault();\n      const {\n        active,\n        title,\n        text,\n        groupValue,\n        picture\n      } = this.state;\n      if (!this.props.isAuthenticated) return false;\n\n      if (active === \"state\") {\n        this.shareText();\n      } else if (active === \"picture\") {\n        this.shareImage();\n      } else if (active === \"link\") {}\n    });\n\n    _defineProperty(this, \"shareText\", () => {\n      const {\n        title,\n        text,\n        groupValue\n      } = this.state;\n      if (!title || !text || groupValue === 0) return false;\n      shareTextPost(title, text, groupValue).then(res => {\n        if (res.durum) {\n          this.props.router.push(\"/nos/\" + res.baslik);\n        } else {\n          toast.error(res.mesaj);\n        }\n      });\n    });\n\n    _defineProperty(this, \"shareImage\", () => {\n      const {\n        title,\n        image,\n        groupValue\n      } = this.state;\n      if (!title || !image || !groupValue) return false;\n      shareImagePost(title, image, groupValue).then(res => {\n        if (res.durum) {\n          this.props.router.push(\"/nos/\" + res.baslik);\n        } else {\n          toast.error(res.mesaj);\n        }\n      });\n    });\n\n    _defineProperty(this, \"onImageChange\", e => {\n      if (e.target.files && e.target.files[0]) {\n        this.setState({\n          image: e.target.files[0]\n        });\n        let reader = new FileReader();\n\n        reader.onload = event => {\n          this.setState({\n            picture: event.target.result\n          });\n        };\n\n        reader.readAsDataURL(e.target.files[0]);\n      }\n    });\n\n    if (props.asyncGroups.length <= 0) {\n      props.fetchGroups();\n    } else {\n      props.groupsSuccess(props.asyncGroups);\n    }\n\n    this.state = {\n      active: \"picture\",\n      title: \"\",\n      text: \"\",\n      groupValue: 0,\n      image: \"\",\n      picture: \"\"\n    };\n  }\n\n  render() {\n    return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Yeni Post\")), __jsx(\"div\", {\n      className: \"content new-post-content\"\n    }, __jsx(\"div\", null, __jsx(\"a\", {\n      onClick: () => this.props.router.back()\n    }, __jsx(\"img\", {\n      src: \"/go-back-icon.png\",\n      alt: \"geri git\"\n    }))), __jsx(\"form\", null, __jsx(\"input\", {\n      type: \"text\",\n      placeholder: \"ba\\u015Fl\\u0131k\",\n      className: \"post-title\",\n      value: this.state.title,\n      onChange: e => this.setState({\n        title: e.target.value\n      }),\n      required: true\n    }), __jsx(\"div\", {\n      className: \"new-post-form\"\n    }, __jsx(\"div\", {\n      className: `tab state-tab ${this.state.active !== \"state\" ? \"hidden\" : \"\"}`\n    }, __jsx(\"textarea\", {\n      className: \"post-content\",\n      placeholder: \"ne d\\xFC\\u015F\\xFCn\\xFCyorsun?\",\n      value: this.state.text,\n      onChange: e => this.setState({\n        text: e.target.value\n      })\n    })), __jsx(\"div\", {\n      className: `tab picture-tab ${this.state.active !== \"picture\" ? \"hidden\" : \"\"}`\n    }, this.state.image ? __jsx(React.Fragment, null, __jsx(\"img\", {\n      src: this.state.picture,\n      alt: \"post resim\"\n    }), __jsx(\"div\", {\n      className: \"picture-tab-footer\"\n    }, __jsx(\"button\", {\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          image: \"\",\n          picture: \"\"\n        });\n      }\n    }, __jsx(\"img\", {\n      src: \"/delete-icon.png\",\n      alt: \"resmi sil\"\n    })))) : __jsx(\"label\", {\n      className: \"custom-file-input\"\n    }, __jsx(\"span\", null, \"G\\xF6zat\"), \"Payla\\u015Fmak istedi\\u011Fin resmi se\\xE7\", __jsx(\"input\", {\n      type: \"file\",\n      value: this.state.image,\n      onChange: this.onImageChange,\n      className: \"file-input\"\n    }))), __jsx(\"div\", {\n      className: `tab link-tab ${this.state.active !== \"link\" ? \"hidden\" : \"\"}`\n    }, \"link\"), __jsx(\"ul\", {\n      className: \"button-container\"\n    }, __jsx(\"li\", null, __jsx(\"button\", {\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          active: \"state\"\n        });\n      }\n    }, \"durum\"), __jsx(\"img\", {\n      src: \"/status-icon.png\",\n      alt: \"post\"\n    })), __jsx(\"li\", null, __jsx(\"button\", {\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          active: \"picture\"\n        });\n      }\n    }, \"g\\xF6rsel\"), __jsx(\"img\", {\n      src: \"/post-picture.png\",\n      alt: \"post\"\n    })), __jsx(\"li\", null, __jsx(\"button\", {\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          active: \"link\"\n        });\n      }\n    }, \"link\"), __jsx(\"img\", {\n      src: \"/post-link.png\",\n      alt: \"post\"\n    })), __jsx(\"li\", null, __jsx(\"button\", {\n      className: \"default-btn share-btn\",\n      onClick: this.shareHandler\n    }, \"payla\\u015F\"))))), __jsx(\"div\", {\n      className: \"groups-input-container\"\n    }, __jsx(\"h4\", null, \"topluluk se\\xE7\"), __jsx(this.RenderGroups, null))), __jsx(\"aside\", {\n      className: \"right-sidebar new-post-sidebar\"\n    }, __jsx(\"p\", null, \"unutma her yazd\\u0131\\u011F\\u0131n yaz\\u0131y\\u0131 bundan y\\u0131llar sonra \\xE7ocuklar\\u0131n hatta torunlar\\u0131n okuyabilir bunun i\\xE7in yazd\\u0131klar\\u0131n\\u0131 senden y\\u0131llar sonraki torunlar\\u0131na \\xF6\\u011F\\xFCt veriyormu\\u015F\\xE7as\\u0131na yaz. Ne kendini utand\\u0131r ne de torunlar\\u0131n\\u0131 yazd\\u0131klar\\u0131ndan dolay\\u0131 utand\\u0131r. Senin yazd\\u0131klar\\u0131ndan etkilenip hayat\\u0131nda radikal kararlar alabilecek insanlar var onlara iyi \\xF6rnek ol.\")));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  groups: state.groups,\n  isAuthenticated: state.auth.isAuthenticated\n});\n\nexport default connect(mapStateToProps, {\n  fetchGroups,\n  groupsSuccess\n})(withRouter(withAuth(NewPost, true)));","map":{"version":3,"sources":["E:/projects/nosbir-frontend/pages/newPost.js"],"names":["React","Component","Head","Link","connect","withRouter","withAuth","fetchGroups","groupsSuccess","Loading","Error","http","shareTextPost","shareImagePost","toast","NewPost","getInitialProps","store","asyncGroups","get","then","res","data","durum","gruplar","catch","err","constructor","props","groups","isLoading","isRejected","errorMsg","length","map","g","i","state","groupValue","group_id","e","changeGroup","name","toLowerCase","id","preventDefault","setState","console","log","active","title","text","picture","isAuthenticated","shareText","shareImage","router","push","baslik","error","mesaj","image","target","files","reader","FileReader","onload","event","result","readAsDataURL","render","back","value","onImageChange","shareHandler","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Head from \"next/head\";\r\nimport Link from \"next/link\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"next/router\";\r\nimport { withAuth } from \"../utils/auth\";\r\nimport { fetchGroups, groupsSuccess } from \"../store/actions/groupActions\";\r\nimport Loading from \"../components/loading\";\r\nimport Error from \"../components/error\";\r\nimport http from \"../utils/http\";\r\nimport { shareTextPost,shareImagePost } from \"../store/actions/shareActions\";\r\nimport { toast } from \"react-toastify\";\r\nclass NewPost extends Component {\r\n  static async getInitialProps({ store }) {\r\n    const asyncGroups = await http\r\n      .get(\"gruplar.php\")\r\n      .then(res => res.data)\r\n      .then(res => {\r\n        if (res.durum) {\r\n          return res.gruplar;\r\n        } else {\r\n          return [];\r\n        }\r\n      })\r\n      .catch(err => []);\r\n    return {\r\n      asyncGroups\r\n    };\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (props.asyncGroups.length <= 0) {\r\n      props.fetchGroups();\r\n    } else {\r\n      props.groupsSuccess(props.asyncGroups);\r\n    }\r\n    this.state = {\r\n      active: \"picture\",\r\n      title: \"\",\r\n      text: \"\",\r\n      groupValue: 0,\r\n      image: \"\",\r\n      picture: \"\"\r\n    };\r\n  }\r\n\r\n  RenderGroups = () => {\r\n    const { groups, isLoading, isRejected, errorMsg } = this.props.groups;\r\n    if (isLoading) return <Loading />;\r\n    else if (isRejected) return <Error msg={errorMsg} />;\r\n    else if (groups.length <= 0)\r\n      return (\r\n        <Error msg=\"Paylaşım yapabileceğiniz grup bulunamadı.Lütfen sonra tekrar deneyin\" />\r\n      );\r\n    else {\r\n      return (\r\n        <ul>\r\n          {groups.map((g, i) => (\r\n            <li key={i}>\r\n              <a\r\n                className={this.state.groupValue === g.group_id ? \"active\" : \"\"}\r\n                onClick={e => this.changeGroup(e, g.group_id)}\r\n              >\r\n                {g.name.toLowerCase()}\r\n              </a>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      );\r\n    }\r\n  };\r\n\r\n  changeGroup = (e, id) => {\r\n    e.preventDefault();\r\n    this.setState({ groupValue: id });\r\n    console.log(this.state.groupValue === id);\r\n  };\r\n\r\n  shareHandler = e => {\r\n    e.preventDefault();\r\n\r\n    const { active, title, text, groupValue, picture } = this.state;\r\n\r\n    if (!this.props.isAuthenticated) return false;\r\n\r\n    if (active === \"state\") {\r\n      this.shareText();\r\n    } else if (active === \"picture\") {\r\n      this.shareImage();\r\n    } else if (active === \"link\") {\r\n    }\r\n  };\r\n\r\n  shareText = () => {\r\n    const { title, text, groupValue } = this.state;\r\n    if (!title || !text || groupValue === 0) return false;\r\n\r\n    shareTextPost(title, text, groupValue).then(res => {\r\n      if(res.durum){\r\n        this.props.router.push(\"/nos/\"+res.baslik);\r\n      }else{\r\n        toast.error(res.mesaj);\r\n      }\r\n    });\r\n  };\r\n\r\n  shareImage=()=>{\r\n    const {title,image,groupValue}=this.state;\r\n    \r\n    if(!title || !image || !groupValue) return false;\r\n\r\n    shareImagePost(title,image,groupValue)\r\n    .then(res=>{\r\n      if(res.durum){\r\n        this.props.router.push(\"/nos/\"+res.baslik);\r\n      }else{\r\n        toast.error(res.mesaj);\r\n      }\r\n    });\r\n  }\r\n\r\n  onImageChange = e => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      this.setState({ image: e.target.files[0] });\r\n      let reader = new FileReader();\r\n      reader.onload = event => {\r\n        this.setState({ picture: event.target.result });\r\n      };\r\n      reader.readAsDataURL(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Head>\r\n          <title>Yeni Post</title>\r\n        </Head>\r\n        <div className=\"content new-post-content\">\r\n          <div>\r\n            <a onClick={() => this.props.router.back()}>\r\n              <img src=\"/go-back-icon.png\" alt=\"geri git\" />\r\n            </a>\r\n          </div>\r\n          <form>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"başlık\"\r\n              className=\"post-title\"\r\n              value={this.state.title}\r\n              onChange={e => this.setState({ title: e.target.value })}\r\n              required={true}\r\n            />\r\n            <div className=\"new-post-form\">\r\n              <div\r\n                className={`tab state-tab ${\r\n                  this.state.active !== \"state\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                <textarea\r\n                  className=\"post-content\"\r\n                  placeholder=\"ne düşünüyorsun?\"\r\n                  value={this.state.text}\r\n                  onChange={e => this.setState({ text: e.target.value })}\r\n                ></textarea>\r\n              </div>\r\n              <div\r\n                className={`tab picture-tab ${\r\n                  this.state.active !== \"picture\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                {this.state.image ? (\r\n                  <>\r\n                    <img src={this.state.picture} alt=\"post resim\" />\r\n                    <div className=\"picture-tab-footer\">\r\n                      <button\r\n                        onClick={e => {\r\n                          e.preventDefault();\r\n                          this.setState({ image: \"\", picture: \"\" });\r\n                        }}\r\n                      >\r\n                        <img src=\"/delete-icon.png\" alt=\"resmi sil\" />\r\n                      </button>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <label className=\"custom-file-input\">\r\n                    <span>Gözat</span>Paylaşmak istediğin resmi seç\r\n                    <input\r\n                      type=\"file\"\r\n                      value={this.state.image}\r\n                      onChange={this.onImageChange}\r\n                      className=\"file-input\"\r\n                    />\r\n                  </label>\r\n                )}\r\n              </div>\r\n              <div\r\n                className={`tab link-tab ${\r\n                  this.state.active !== \"link\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                link\r\n              </div>\r\n              <ul className=\"button-container\">\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"state\" });\r\n                    }}\r\n                  >\r\n                    durum\r\n                  </button>\r\n                  <img src=\"/status-icon.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"picture\" });\r\n                    }}\r\n                  >\r\n                    görsel\r\n                  </button>\r\n                  <img src=\"/post-picture.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"link\" });\r\n                    }}\r\n                  >\r\n                    link\r\n                  </button>\r\n                  <img src=\"/post-link.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    className=\"default-btn share-btn\"\r\n                    onClick={this.shareHandler}\r\n                  >\r\n                    paylaş\r\n                  </button>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </form>\r\n          <div className=\"groups-input-container\">\r\n            <h4>topluluk seç</h4>\r\n            <this.RenderGroups />\r\n          </div>\r\n        </div>\r\n        <aside className=\"right-sidebar new-post-sidebar\">\r\n          <p>\r\n            unutma her yazdığın yazıyı bundan yıllar sonra çocukların hatta\r\n            torunların okuyabilir bunun için yazdıklarını senden yıllar sonraki\r\n            torunlarına öğüt veriyormuşçasına yaz. Ne kendini utandır ne de\r\n            torunlarını yazdıklarından dolayı utandır. Senin yazdıklarından\r\n            etkilenip hayatında radikal kararlar alabilecek insanlar var onlara\r\n            iyi örnek ol.\r\n          </p>\r\n        </aside>\r\n      </>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => ({\r\n  groups: state.groups,\r\n  isAuthenticated: state.auth.isAuthenticated\r\n});\r\nexport default connect(mapStateToProps, { fetchGroups, groupsSuccess })(\r\n  withRouter(withAuth(NewPost, true))\r\n);\r\n"]},"metadata":{},"sourceType":"module"}