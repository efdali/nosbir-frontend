{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component } from \"react\";\nimport Head from \"next/head\";\nimport Link from \"next/link\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"next/router\";\nimport { withAuth } from \"../utils/auth\";\nimport { fetchGroups, groupsSuccess } from \"../store/actions/groupActions\";\nimport Loading from \"../components/loading\";\nimport Error from \"../components/error\";\nimport http from \"../utils/http\";\nimport { shareTextPost, shareImagePost } from \"../store/actions/shareActions\";\nimport { toast } from \"react-toastify\";\n\nvar NewPost =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NewPost, _Component);\n\n  _createClass(NewPost, null, [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var store, asyncGroups;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                store = _ref.store;\n                _context.next = 3;\n                return http.get(\"gruplar.php\").then(function (res) {\n                  return res.data;\n                }).then(function (res) {\n                  if (res.durum) {\n                    return res.gruplar;\n                  } else {\n                    return [];\n                  }\n                })[\"catch\"](function (err) {\n                  return [];\n                });\n\n              case 3:\n                asyncGroups = _context.sent;\n                return _context.abrupt(\"return\", {\n                  asyncGroups: asyncGroups\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  function NewPost(props) {\n    var _this;\n\n    _classCallCheck(this, NewPost);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(NewPost).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"RenderGroups\", function () {\n      var _this$props$groups = _this.props.groups,\n          groups = _this$props$groups.groups,\n          isLoading = _this$props$groups.isLoading,\n          isRejected = _this$props$groups.isRejected,\n          errorMsg = _this$props$groups.errorMsg;\n      if (isLoading) return __jsx(Loading, null);else if (isRejected) return __jsx(Error, {\n        msg: errorMsg\n      });else if (groups.length <= 0) return __jsx(Error, {\n        msg: \"Payla\\u015F\\u0131m yapabilece\\u011Finiz grup bulunamad\\u0131.L\\xFCtfen sonra tekrar deneyin\"\n      });else {\n        return __jsx(\"ul\", null, groups.map(function (g, i) {\n          return __jsx(\"li\", {\n            key: i\n          }, __jsx(\"a\", {\n            className: _this.state.groupValue === g.group_id ? \"active\" : \"\",\n            onClick: function onClick(e) {\n              return _this.changeGroup(e, g.group_id);\n            }\n          }, g.name.toLowerCase()));\n        }));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeGroup\", function (e, id) {\n      e.preventDefault();\n\n      _this.setState({\n        groupValue: id\n      });\n\n      console.log(_this.state.groupValue === id);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"shareHandler\", function (e) {\n      e.preventDefault();\n      var _this$state = _this.state,\n          active = _this$state.active,\n          title = _this$state.title,\n          text = _this$state.text,\n          groupValue = _this$state.groupValue,\n          picture = _this$state.picture;\n      if (!_this.props.isAuthenticated) return false;\n\n      if (active === \"state\") {\n        _this.shareText();\n      } else if (active === \"picture\") {\n        _this.shareImage();\n      } else if (active === \"link\") {}\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"shareText\", function () {\n      var _this$state2 = _this.state,\n          title = _this$state2.title,\n          text = _this$state2.text,\n          groupValue = _this$state2.groupValue;\n      if (!title || !text || groupValue === 0) return false;\n      shareTextPost(title, text, groupValue).then(function (res) {\n        if (res.durum) {\n          _this.props.router.push(\"/nos/\" + res.baslik);\n        } else {\n          toast.error(res.mesaj);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"shareImage\", function () {\n      var _this$state3 = _this.state,\n          title = _this$state3.title,\n          image = _this$state3.image,\n          groupValue = _this$state3.groupValue;\n      if (!title || !image || !groupValue) return false;\n      shareImagePost(title, image, groupValue).then(function (res) {\n        if (res.durum) {\n          _this.props.router.push(\"/nos/\" + res.baslik);\n        } else {\n          toast.error(res.mesaj);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onImageChange\", function (e) {\n      if (e.target.files && e.target.files[0]) {\n        _this.setState({\n          image: e.target.files[0]\n        });\n\n        var reader = new FileReader();\n\n        reader.onload = function (event) {\n          _this.setState({\n            picture: event.target.result\n          });\n        };\n\n        reader.readAsDataURL(e.target.files[0]);\n      }\n    });\n\n    if (props.asyncGroups.length <= 0) {\n      props.fetchGroups();\n    } else {\n      props.groupsSuccess(props.asyncGroups);\n    }\n\n    _this.state = {\n      active: \"picture\",\n      title: \"\",\n      text: \"\",\n      groupValue: 0,\n      image: \"\",\n      picture: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(NewPost, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"Yeni Post\")), __jsx(\"div\", {\n        className: \"content new-post-content\"\n      }, __jsx(\"div\", null, __jsx(\"a\", {\n        onClick: function onClick() {\n          return _this2.props.router.back();\n        }\n      }, __jsx(\"img\", {\n        src: \"/go-back-icon.png\",\n        alt: \"geri git\"\n      }))), __jsx(\"form\", null, __jsx(\"input\", {\n        type: \"text\",\n        placeholder: \"ba\\u015Fl\\u0131k\",\n        className: \"post-title\",\n        value: this.state.title,\n        onChange: function onChange(e) {\n          return _this2.setState({\n            title: e.target.value\n          });\n        },\n        required: true\n      }), __jsx(\"div\", {\n        className: \"new-post-form\"\n      }, __jsx(\"div\", {\n        className: \"tab state-tab \".concat(this.state.active !== \"state\" ? \"hidden\" : \"\")\n      }, __jsx(\"textarea\", {\n        className: \"post-content\",\n        placeholder: \"ne d\\xFC\\u015F\\xFCn\\xFCyorsun?\",\n        value: this.state.text,\n        onChange: function onChange(e) {\n          return _this2.setState({\n            text: e.target.value\n          });\n        }\n      })), __jsx(\"div\", {\n        className: \"tab picture-tab \".concat(this.state.active !== \"picture\" ? \"hidden\" : \"\")\n      }, this.state.image ? __jsx(React.Fragment, null, __jsx(\"img\", {\n        src: this.state.picture,\n        alt: \"post resim\"\n      }), __jsx(\"div\", {\n        className: \"picture-tab-footer\"\n      }, __jsx(\"button\", {\n        onClick: function onClick(e) {\n          e.preventDefault();\n\n          _this2.setState({\n            image: \"\",\n            picture: \"\"\n          });\n        }\n      }, __jsx(\"img\", {\n        src: \"/delete-icon.png\",\n        alt: \"resmi sil\"\n      })))) : __jsx(\"label\", {\n        className: \"custom-file-input\"\n      }, __jsx(\"span\", null, \"G\\xF6zat\"), \"Payla\\u015Fmak istedi\\u011Fin resmi se\\xE7\", __jsx(\"input\", {\n        type: \"file\",\n        value: this.state.image,\n        onChange: this.onImageChange,\n        className: \"file-input\"\n      }))), __jsx(\"div\", {\n        className: \"tab link-tab \".concat(this.state.active !== \"link\" ? \"hidden\" : \"\")\n      }, \"link\"), __jsx(\"ul\", {\n        className: \"button-container\"\n      }, __jsx(\"li\", null, __jsx(\"button\", {\n        onClick: function onClick(e) {\n          e.preventDefault();\n\n          _this2.setState({\n            active: \"state\"\n          });\n        }\n      }, \"durum\"), __jsx(\"img\", {\n        src: \"/status-icon.png\",\n        alt: \"post\"\n      })), __jsx(\"li\", null, __jsx(\"button\", {\n        onClick: function onClick(e) {\n          e.preventDefault();\n\n          _this2.setState({\n            active: \"picture\"\n          });\n        }\n      }, \"g\\xF6rsel\"), __jsx(\"img\", {\n        src: \"/post-picture.png\",\n        alt: \"post\"\n      })), __jsx(\"li\", null, __jsx(\"button\", {\n        onClick: function onClick(e) {\n          e.preventDefault();\n\n          _this2.setState({\n            active: \"link\"\n          });\n        }\n      }, \"link\"), __jsx(\"img\", {\n        src: \"/post-link.png\",\n        alt: \"post\"\n      })), __jsx(\"li\", null, __jsx(\"button\", {\n        className: \"default-btn share-btn\",\n        onClick: this.shareHandler\n      }, \"payla\\u015F\"))))), __jsx(\"div\", {\n        className: \"groups-input-container\"\n      }, __jsx(\"h4\", null, \"topluluk se\\xE7\"), __jsx(this.RenderGroups, null))), __jsx(\"aside\", {\n        className: \"right-sidebar new-post-sidebar\"\n      }, __jsx(\"p\", null, \"unutma her yazd\\u0131\\u011F\\u0131n yaz\\u0131y\\u0131 bundan y\\u0131llar sonra \\xE7ocuklar\\u0131n hatta torunlar\\u0131n okuyabilir bunun i\\xE7in yazd\\u0131klar\\u0131n\\u0131 senden y\\u0131llar sonraki torunlar\\u0131na \\xF6\\u011F\\xFCt veriyormu\\u015F\\xE7as\\u0131na yaz. Ne kendini utand\\u0131r ne de torunlar\\u0131n\\u0131 yazd\\u0131klar\\u0131ndan dolay\\u0131 utand\\u0131r. Senin yazd\\u0131klar\\u0131ndan etkilenip hayat\\u0131nda radikal kararlar alabilecek insanlar var onlara iyi \\xF6rnek ol.\")));\n    }\n  }]);\n\n  return NewPost;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    groups: state.groups,\n    isAuthenticated: state.auth.isAuthenticated\n  };\n};\n\nexport default connect(mapStateToProps, {\n  fetchGroups: fetchGroups,\n  groupsSuccess: groupsSuccess\n})(withRouter(withAuth(NewPost, true)));","map":{"version":3,"sources":["E:/projects/nosbir-frontend/pages/newPost.js"],"names":["React","Component","Head","Link","connect","withRouter","withAuth","fetchGroups","groupsSuccess","Loading","Error","http","shareTextPost","shareImagePost","toast","NewPost","store","get","then","res","data","durum","gruplar","err","asyncGroups","props","groups","isLoading","isRejected","errorMsg","length","map","g","i","state","groupValue","group_id","e","changeGroup","name","toLowerCase","id","preventDefault","setState","console","log","active","title","text","picture","isAuthenticated","shareText","shareImage","router","push","baslik","error","mesaj","image","target","files","reader","FileReader","onload","event","result","readAsDataURL","back","value","onImageChange","shareHandler","mapStateToProps","auth"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,UAAT,QAA2B,aAA3B;AACA,SAASC,QAAT,QAAyB,eAAzB;AACA,SAASC,WAAT,EAAsBC,aAAtB,QAA2C,+BAA3C;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,IAAP,MAAiB,eAAjB;AACA,SAASC,aAAT,EAAuBC,cAAvB,QAA6C,+BAA7C;AACA,SAASC,KAAT,QAAsB,gBAAtB;;IACMC,O;;;;;;;;;;;;;;;;AAC2BC,gBAAAA,K,QAAAA,K;;uBACHL,IAAI,CAC3BM,GADuB,CACnB,aADmB,EAEvBC,IAFuB,CAElB,UAAAC,GAAG;AAAA,yBAAIA,GAAG,CAACC,IAAR;AAAA,iBAFe,EAGvBF,IAHuB,CAGlB,UAAAC,GAAG,EAAI;AACX,sBAAIA,GAAG,CAACE,KAAR,EAAe;AACb,2BAAOF,GAAG,CAACG,OAAX;AACD,mBAFD,MAEO;AACL,2BAAO,EAAP;AACD;AACF,iBATuB,WAUjB,UAAAC,GAAG;AAAA,yBAAI,EAAJ;AAAA,iBAVc,C;;;AAApBC,gBAAAA,W;iDAWC;AACLA,kBAAAA,WAAW,EAAXA;AADK,iB;;;;;;;;;;;;;;;;;;AAKT,mBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,iFAAMA,KAAN;;AADiB,mEAkBJ,YAAM;AAAA,+BACiC,MAAKA,KAAL,CAAWC,MAD5C;AAAA,UACXA,MADW,sBACXA,MADW;AAAA,UACHC,SADG,sBACHA,SADG;AAAA,UACQC,UADR,sBACQA,UADR;AAAA,UACoBC,QADpB,sBACoBA,QADpB;AAEnB,UAAIF,SAAJ,EAAe,OAAO,MAAC,OAAD,OAAP,CAAf,KACK,IAAIC,UAAJ,EAAgB,OAAO,MAAC,KAAD;AAAO,QAAA,GAAG,EAAEC;AAAZ,QAAP,CAAhB,KACA,IAAIH,MAAM,CAACI,MAAP,IAAiB,CAArB,EACH,OACE,MAAC,KAAD;AAAO,QAAA,GAAG,EAAC;AAAX,QADF,CADG,KAIA;AACH,eACE,kBACGJ,MAAM,CAACK,GAAP,CAAW,UAACC,CAAD,EAAIC,CAAJ;AAAA,iBACV;AAAI,YAAA,GAAG,EAAEA;AAAT,aACE;AACE,YAAA,SAAS,EAAE,MAAKC,KAAL,CAAWC,UAAX,KAA0BH,CAAC,CAACI,QAA5B,GAAuC,QAAvC,GAAkD,EAD/D;AAEE,YAAA,OAAO,EAAE,iBAAAC,CAAC;AAAA,qBAAI,MAAKC,WAAL,CAAiBD,CAAjB,EAAoBL,CAAC,CAACI,QAAtB,CAAJ;AAAA;AAFZ,aAIGJ,CAAC,CAACO,IAAF,CAAOC,WAAP,EAJH,CADF,CADU;AAAA,SAAX,CADH,CADF;AAcD;AACF,KA1CkB;;AAAA,kEA4CL,UAACH,CAAD,EAAII,EAAJ,EAAW;AACvBJ,MAAAA,CAAC,CAACK,cAAF;;AACA,YAAKC,QAAL,CAAc;AAAER,QAAAA,UAAU,EAAEM;AAAd,OAAd;;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKX,KAAL,CAAWC,UAAX,KAA0BM,EAAtC;AACD,KAhDkB;;AAAA,mEAkDJ,UAAAJ,CAAC,EAAI;AAClBA,MAAAA,CAAC,CAACK,cAAF;AADkB,wBAGmC,MAAKR,KAHxC;AAAA,UAGVY,MAHU,eAGVA,MAHU;AAAA,UAGFC,KAHE,eAGFA,KAHE;AAAA,UAGKC,IAHL,eAGKA,IAHL;AAAA,UAGWb,UAHX,eAGWA,UAHX;AAAA,UAGuBc,OAHvB,eAGuBA,OAHvB;AAKlB,UAAI,CAAC,MAAKxB,KAAL,CAAWyB,eAAhB,EAAiC,OAAO,KAAP;;AAEjC,UAAIJ,MAAM,KAAK,OAAf,EAAwB;AACtB,cAAKK,SAAL;AACD,OAFD,MAEO,IAAIL,MAAM,KAAK,SAAf,EAA0B;AAC/B,cAAKM,UAAL;AACD,OAFM,MAEA,IAAIN,MAAM,KAAK,MAAf,EAAuB,CAC7B;AACF,KA/DkB;;AAAA,gEAiEP,YAAM;AAAA,yBACoB,MAAKZ,KADzB;AAAA,UACRa,KADQ,gBACRA,KADQ;AAAA,UACDC,IADC,gBACDA,IADC;AAAA,UACKb,UADL,gBACKA,UADL;AAEhB,UAAI,CAACY,KAAD,IAAU,CAACC,IAAX,IAAmBb,UAAU,KAAK,CAAtC,EAAyC,OAAO,KAAP;AAEzCvB,MAAAA,aAAa,CAACmC,KAAD,EAAQC,IAAR,EAAcb,UAAd,CAAb,CAAuCjB,IAAvC,CAA4C,UAAAC,GAAG,EAAI;AACjD,YAAGA,GAAG,CAACE,KAAP,EAAa;AACX,gBAAKI,KAAL,CAAW4B,MAAX,CAAkBC,IAAlB,CAAuB,UAAQnC,GAAG,CAACoC,MAAnC;AACD,SAFD,MAEK;AACHzC,UAAAA,KAAK,CAAC0C,KAAN,CAAYrC,GAAG,CAACsC,KAAhB;AACD;AACF,OAND;AAOD,KA5EkB;;AAAA,iEA8ER,YAAI;AAAA,yBACkB,MAAKvB,KADvB;AAAA,UACNa,KADM,gBACNA,KADM;AAAA,UACAW,KADA,gBACAA,KADA;AAAA,UACMvB,UADN,gBACMA,UADN;AAGb,UAAG,CAACY,KAAD,IAAU,CAACW,KAAX,IAAoB,CAACvB,UAAxB,EAAoC,OAAO,KAAP;AAEpCtB,MAAAA,cAAc,CAACkC,KAAD,EAAOW,KAAP,EAAavB,UAAb,CAAd,CACCjB,IADD,CACM,UAAAC,GAAG,EAAE;AACT,YAAGA,GAAG,CAACE,KAAP,EAAa;AACX,gBAAKI,KAAL,CAAW4B,MAAX,CAAkBC,IAAlB,CAAuB,UAAQnC,GAAG,CAACoC,MAAnC;AACD,SAFD,MAEK;AACHzC,UAAAA,KAAK,CAAC0C,KAAN,CAAYrC,GAAG,CAACsC,KAAhB;AACD;AACF,OAPD;AAQD,KA3FkB;;AAAA,oEA6FH,UAAApB,CAAC,EAAI;AACnB,UAAIA,CAAC,CAACsB,MAAF,CAASC,KAAT,IAAkBvB,CAAC,CAACsB,MAAF,CAASC,KAAT,CAAe,CAAf,CAAtB,EAAyC;AACvC,cAAKjB,QAAL,CAAc;AAAEe,UAAAA,KAAK,EAAErB,CAAC,CAACsB,MAAF,CAASC,KAAT,CAAe,CAAf;AAAT,SAAd;;AACA,YAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,QAAAA,MAAM,CAACE,MAAP,GAAgB,UAAAC,KAAK,EAAI;AACvB,gBAAKrB,QAAL,CAAc;AAAEM,YAAAA,OAAO,EAAEe,KAAK,CAACL,MAAN,CAAaM;AAAxB,WAAd;AACD,SAFD;;AAGAJ,QAAAA,MAAM,CAACK,aAAP,CAAqB7B,CAAC,CAACsB,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB;AACD;AACF,KAtGkB;;AAGjB,QAAInC,KAAK,CAACD,WAAN,CAAkBM,MAAlB,IAA4B,CAAhC,EAAmC;AACjCL,MAAAA,KAAK,CAAClB,WAAN;AACD,KAFD,MAEO;AACLkB,MAAAA,KAAK,CAACjB,aAAN,CAAoBiB,KAAK,CAACD,WAA1B;AACD;;AACD,UAAKU,KAAL,GAAa;AACXY,MAAAA,MAAM,EAAE,SADG;AAEXC,MAAAA,KAAK,EAAE,EAFI;AAGXC,MAAAA,IAAI,EAAE,EAHK;AAIXb,MAAAA,UAAU,EAAE,CAJD;AAKXuB,MAAAA,KAAK,EAAE,EALI;AAMXT,MAAAA,OAAO,EAAE;AANE,KAAb;AARiB;AAgBlB;;;;6BAwFQ;AAAA;;AACP,aACE,4BACE,MAAC,IAAD,QACE,iCADF,CADF,EAIE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE,mBACE;AAAG,QAAA,OAAO,EAAE;AAAA,iBAAM,MAAI,CAACxB,KAAL,CAAW4B,MAAX,CAAkBc,IAAlB,EAAN;AAAA;AAAZ,SACE;AAAK,QAAA,GAAG,EAAC,mBAAT;AAA6B,QAAA,GAAG,EAAC;AAAjC,QADF,CADF,CADF,EAME,oBACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,WAAW,EAAC,kBAFd;AAGE,QAAA,SAAS,EAAC,YAHZ;AAIE,QAAA,KAAK,EAAE,KAAKjC,KAAL,CAAWa,KAJpB;AAKE,QAAA,QAAQ,EAAE,kBAAAV,CAAC;AAAA,iBAAI,MAAI,CAACM,QAAL,CAAc;AAAEI,YAAAA,KAAK,EAAEV,CAAC,CAACsB,MAAF,CAASS;AAAlB,WAAd,CAAJ;AAAA,SALb;AAME,QAAA,QAAQ,EAAE;AANZ,QADF,EASE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AACE,QAAA,SAAS,0BACP,KAAKlC,KAAL,CAAWY,MAAX,KAAsB,OAAtB,GAAgC,QAAhC,GAA2C,EADpC;AADX,SAKE;AACE,QAAA,SAAS,EAAC,cADZ;AAEE,QAAA,WAAW,EAAC,gCAFd;AAGE,QAAA,KAAK,EAAE,KAAKZ,KAAL,CAAWc,IAHpB;AAIE,QAAA,QAAQ,EAAE,kBAAAX,CAAC;AAAA,iBAAI,MAAI,CAACM,QAAL,CAAc;AAAEK,YAAAA,IAAI,EAAEX,CAAC,CAACsB,MAAF,CAASS;AAAjB,WAAd,CAAJ;AAAA;AAJb,QALF,CADF,EAaE;AACE,QAAA,SAAS,4BACP,KAAKlC,KAAL,CAAWY,MAAX,KAAsB,SAAtB,GAAkC,QAAlC,GAA6C,EADtC;AADX,SAKG,KAAKZ,KAAL,CAAWwB,KAAX,GACC,4BACE;AAAK,QAAA,GAAG,EAAE,KAAKxB,KAAL,CAAWe,OAArB;AAA8B,QAAA,GAAG,EAAC;AAAlC,QADF,EAEE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AACE,QAAA,OAAO,EAAE,iBAAAZ,CAAC,EAAI;AACZA,UAAAA,CAAC,CAACK,cAAF;;AACA,UAAA,MAAI,CAACC,QAAL,CAAc;AAAEe,YAAAA,KAAK,EAAE,EAAT;AAAaT,YAAAA,OAAO,EAAE;AAAtB,WAAd;AACD;AAJH,SAME;AAAK,QAAA,GAAG,EAAC,kBAAT;AAA4B,QAAA,GAAG,EAAC;AAAhC,QANF,CADF,CAFF,CADD,GAeC;AAAO,QAAA,SAAS,EAAC;AAAjB,SACE,+BADF,gDAEE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,KAAK,EAAE,KAAKf,KAAL,CAAWwB,KAFpB;AAGE,QAAA,QAAQ,EAAE,KAAKW,aAHjB;AAIE,QAAA,SAAS,EAAC;AAJZ,QAFF,CApBJ,CAbF,EA4CE;AACE,QAAA,SAAS,yBACP,KAAKnC,KAAL,CAAWY,MAAX,KAAsB,MAAtB,GAA+B,QAA/B,GAA0C,EADnC;AADX,gBA5CF,EAmDE;AAAI,QAAA,SAAS,EAAC;AAAd,SACE,kBACE;AACE,QAAA,OAAO,EAAE,iBAAAT,CAAC,EAAI;AACZA,UAAAA,CAAC,CAACK,cAAF;;AACA,UAAA,MAAI,CAACC,QAAL,CAAc;AAAEG,YAAAA,MAAM,EAAE;AAAV,WAAd;AACD;AAJH,iBADF,EASE;AAAK,QAAA,GAAG,EAAC,kBAAT;AAA4B,QAAA,GAAG,EAAC;AAAhC,QATF,CADF,EAYE,kBACE;AACE,QAAA,OAAO,EAAE,iBAAAT,CAAC,EAAI;AACZA,UAAAA,CAAC,CAACK,cAAF;;AACA,UAAA,MAAI,CAACC,QAAL,CAAc;AAAEG,YAAAA,MAAM,EAAE;AAAV,WAAd;AACD;AAJH,qBADF,EASE;AAAK,QAAA,GAAG,EAAC,mBAAT;AAA6B,QAAA,GAAG,EAAC;AAAjC,QATF,CAZF,EAuBE,kBACE;AACE,QAAA,OAAO,EAAE,iBAAAT,CAAC,EAAI;AACZA,UAAAA,CAAC,CAACK,cAAF;;AACA,UAAA,MAAI,CAACC,QAAL,CAAc;AAAEG,YAAAA,MAAM,EAAE;AAAV,WAAd;AACD;AAJH,gBADF,EASE;AAAK,QAAA,GAAG,EAAC,gBAAT;AAA0B,QAAA,GAAG,EAAC;AAA9B,QATF,CAvBF,EAkCE,kBACE;AACE,QAAA,SAAS,EAAC,uBADZ;AAEE,QAAA,OAAO,EAAE,KAAKwB;AAFhB,uBADF,CAlCF,CAnDF,CATF,CANF,EA+GE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE,oCADF,EAEE,WAAM,YAAN,OAFF,CA/GF,CAJF,EAwHE;AAAO,QAAA,SAAS,EAAC;AAAjB,SACE,6fADF,CAxHF,CADF;AAqID;;;;EAhQmBrE,S;;AAkQtB,IAAMsE,eAAe,GAAG,SAAlBA,eAAkB,CAAArC,KAAK;AAAA,SAAK;AAChCR,IAAAA,MAAM,EAAEQ,KAAK,CAACR,MADkB;AAEhCwB,IAAAA,eAAe,EAAEhB,KAAK,CAACsC,IAAN,CAAWtB;AAFI,GAAL;AAAA,CAA7B;;AAIA,eAAe9C,OAAO,CAACmE,eAAD,EAAkB;AAAEhE,EAAAA,WAAW,EAAXA,WAAF;AAAeC,EAAAA,aAAa,EAAbA;AAAf,CAAlB,CAAP,CACbH,UAAU,CAACC,QAAQ,CAACS,OAAD,EAAU,IAAV,CAAT,CADG,CAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport Head from \"next/head\";\r\nimport Link from \"next/link\";\r\nimport { connect } from \"react-redux\";\r\nimport { withRouter } from \"next/router\";\r\nimport { withAuth } from \"../utils/auth\";\r\nimport { fetchGroups, groupsSuccess } from \"../store/actions/groupActions\";\r\nimport Loading from \"../components/loading\";\r\nimport Error from \"../components/error\";\r\nimport http from \"../utils/http\";\r\nimport { shareTextPost,shareImagePost } from \"../store/actions/shareActions\";\r\nimport { toast } from \"react-toastify\";\r\nclass NewPost extends Component {\r\n  static async getInitialProps({ store }) {\r\n    const asyncGroups = await http\r\n      .get(\"gruplar.php\")\r\n      .then(res => res.data)\r\n      .then(res => {\r\n        if (res.durum) {\r\n          return res.gruplar;\r\n        } else {\r\n          return [];\r\n        }\r\n      })\r\n      .catch(err => []);\r\n    return {\r\n      asyncGroups\r\n    };\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    if (props.asyncGroups.length <= 0) {\r\n      props.fetchGroups();\r\n    } else {\r\n      props.groupsSuccess(props.asyncGroups);\r\n    }\r\n    this.state = {\r\n      active: \"picture\",\r\n      title: \"\",\r\n      text: \"\",\r\n      groupValue: 0,\r\n      image: \"\",\r\n      picture: \"\"\r\n    };\r\n  }\r\n\r\n  RenderGroups = () => {\r\n    const { groups, isLoading, isRejected, errorMsg } = this.props.groups;\r\n    if (isLoading) return <Loading />;\r\n    else if (isRejected) return <Error msg={errorMsg} />;\r\n    else if (groups.length <= 0)\r\n      return (\r\n        <Error msg=\"Paylaşım yapabileceğiniz grup bulunamadı.Lütfen sonra tekrar deneyin\" />\r\n      );\r\n    else {\r\n      return (\r\n        <ul>\r\n          {groups.map((g, i) => (\r\n            <li key={i}>\r\n              <a\r\n                className={this.state.groupValue === g.group_id ? \"active\" : \"\"}\r\n                onClick={e => this.changeGroup(e, g.group_id)}\r\n              >\r\n                {g.name.toLowerCase()}\r\n              </a>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      );\r\n    }\r\n  };\r\n\r\n  changeGroup = (e, id) => {\r\n    e.preventDefault();\r\n    this.setState({ groupValue: id });\r\n    console.log(this.state.groupValue === id);\r\n  };\r\n\r\n  shareHandler = e => {\r\n    e.preventDefault();\r\n\r\n    const { active, title, text, groupValue, picture } = this.state;\r\n\r\n    if (!this.props.isAuthenticated) return false;\r\n\r\n    if (active === \"state\") {\r\n      this.shareText();\r\n    } else if (active === \"picture\") {\r\n      this.shareImage();\r\n    } else if (active === \"link\") {\r\n    }\r\n  };\r\n\r\n  shareText = () => {\r\n    const { title, text, groupValue } = this.state;\r\n    if (!title || !text || groupValue === 0) return false;\r\n\r\n    shareTextPost(title, text, groupValue).then(res => {\r\n      if(res.durum){\r\n        this.props.router.push(\"/nos/\"+res.baslik);\r\n      }else{\r\n        toast.error(res.mesaj);\r\n      }\r\n    });\r\n  };\r\n\r\n  shareImage=()=>{\r\n    const {title,image,groupValue}=this.state;\r\n    \r\n    if(!title || !image || !groupValue) return false;\r\n\r\n    shareImagePost(title,image,groupValue)\r\n    .then(res=>{\r\n      if(res.durum){\r\n        this.props.router.push(\"/nos/\"+res.baslik);\r\n      }else{\r\n        toast.error(res.mesaj);\r\n      }\r\n    });\r\n  }\r\n\r\n  onImageChange = e => {\r\n    if (e.target.files && e.target.files[0]) {\r\n      this.setState({ image: e.target.files[0] });\r\n      let reader = new FileReader();\r\n      reader.onload = event => {\r\n        this.setState({ picture: event.target.result });\r\n      };\r\n      reader.readAsDataURL(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <Head>\r\n          <title>Yeni Post</title>\r\n        </Head>\r\n        <div className=\"content new-post-content\">\r\n          <div>\r\n            <a onClick={() => this.props.router.back()}>\r\n              <img src=\"/go-back-icon.png\" alt=\"geri git\" />\r\n            </a>\r\n          </div>\r\n          <form>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"başlık\"\r\n              className=\"post-title\"\r\n              value={this.state.title}\r\n              onChange={e => this.setState({ title: e.target.value })}\r\n              required={true}\r\n            />\r\n            <div className=\"new-post-form\">\r\n              <div\r\n                className={`tab state-tab ${\r\n                  this.state.active !== \"state\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                <textarea\r\n                  className=\"post-content\"\r\n                  placeholder=\"ne düşünüyorsun?\"\r\n                  value={this.state.text}\r\n                  onChange={e => this.setState({ text: e.target.value })}\r\n                ></textarea>\r\n              </div>\r\n              <div\r\n                className={`tab picture-tab ${\r\n                  this.state.active !== \"picture\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                {this.state.image ? (\r\n                  <>\r\n                    <img src={this.state.picture} alt=\"post resim\" />\r\n                    <div className=\"picture-tab-footer\">\r\n                      <button\r\n                        onClick={e => {\r\n                          e.preventDefault();\r\n                          this.setState({ image: \"\", picture: \"\" });\r\n                        }}\r\n                      >\r\n                        <img src=\"/delete-icon.png\" alt=\"resmi sil\" />\r\n                      </button>\r\n                    </div>\r\n                  </>\r\n                ) : (\r\n                  <label className=\"custom-file-input\">\r\n                    <span>Gözat</span>Paylaşmak istediğin resmi seç\r\n                    <input\r\n                      type=\"file\"\r\n                      value={this.state.image}\r\n                      onChange={this.onImageChange}\r\n                      className=\"file-input\"\r\n                    />\r\n                  </label>\r\n                )}\r\n              </div>\r\n              <div\r\n                className={`tab link-tab ${\r\n                  this.state.active !== \"link\" ? \"hidden\" : \"\"\r\n                }`}\r\n              >\r\n                link\r\n              </div>\r\n              <ul className=\"button-container\">\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"state\" });\r\n                    }}\r\n                  >\r\n                    durum\r\n                  </button>\r\n                  <img src=\"/status-icon.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"picture\" });\r\n                    }}\r\n                  >\r\n                    görsel\r\n                  </button>\r\n                  <img src=\"/post-picture.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    onClick={e => {\r\n                      e.preventDefault();\r\n                      this.setState({ active: \"link\" });\r\n                    }}\r\n                  >\r\n                    link\r\n                  </button>\r\n                  <img src=\"/post-link.png\" alt=\"post\" />\r\n                </li>\r\n                <li>\r\n                  <button\r\n                    className=\"default-btn share-btn\"\r\n                    onClick={this.shareHandler}\r\n                  >\r\n                    paylaş\r\n                  </button>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </form>\r\n          <div className=\"groups-input-container\">\r\n            <h4>topluluk seç</h4>\r\n            <this.RenderGroups />\r\n          </div>\r\n        </div>\r\n        <aside className=\"right-sidebar new-post-sidebar\">\r\n          <p>\r\n            unutma her yazdığın yazıyı bundan yıllar sonra çocukların hatta\r\n            torunların okuyabilir bunun için yazdıklarını senden yıllar sonraki\r\n            torunlarına öğüt veriyormuşçasına yaz. Ne kendini utandır ne de\r\n            torunlarını yazdıklarından dolayı utandır. Senin yazdıklarından\r\n            etkilenip hayatında radikal kararlar alabilecek insanlar var onlara\r\n            iyi örnek ol.\r\n          </p>\r\n        </aside>\r\n      </>\r\n    );\r\n  }\r\n}\r\nconst mapStateToProps = state => ({\r\n  groups: state.groups,\r\n  isAuthenticated: state.auth.isAuthenticated\r\n});\r\nexport default connect(mapStateToProps, { fetchGroups, groupsSuccess })(\r\n  withRouter(withAuth(NewPost, true))\r\n);\r\n"]},"metadata":{},"sourceType":"module"}